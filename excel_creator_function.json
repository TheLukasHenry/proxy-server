[
  {
    "id": "excel_creator",
    "name": "Excel Creator",
    "meta": {
      "description": "Creates Excel files with data and formulas"
    },
    "content": "\"\"\"\ntitle: Excel Creator\nauthor: MCP Team\nversion: 0.1.0\nrequirements: openpyxl\n\"\"\"\n\nimport base64\nimport io\nfrom datetime import datetime\n\n\nclass Tools:\n    def __init__(self):\n        pass\n\n    def create_excel(self, title: str, headers: str, data: str) -> str:\n        \"\"\"\n        Create an Excel file with data and SUM formulas.\n        \n        Args:\n            title: Name for the Excel file\n            headers: Comma-separated headers like Product,Jan,Feb,Mar\n            data: Pipe-separated rows like Widget,100,120,90|Gadget,150,140,160\n        \"\"\"\n        try:\n            from openpyxl import Workbook\n            from openpyxl.styles import Font\n            from openpyxl.utils import get_column_letter\n        except ImportError:\n            return \"openpyxl not installed\"\n\n        wb = Workbook()\n        ws = wb.active\n        ws.title = title[:31]\n\n        header_list = [h.strip() for h in headers.split(\",\")]\n        for col, header in enumerate(header_list, 1):\n            ws.cell(row=1, column=col, value=header).font = Font(bold=True)\n\n        row_num = 2\n        for row_str in data.split(\"|\"):\n            col_num = 1\n            for val in row_str.split(\",\"):\n                val = val.strip()\n                try:\n                    val = int(val)\n                except ValueError:\n                    pass\n                ws.cell(row=row_num, column=col_num, value=val)\n                col_num += 1\n            row_num += 1\n\n        # Add totals row\n        ws.cell(row=row_num, column=1, value=\"TOTAL\").font = Font(bold=True)\n        for col in range(2, len(header_list) + 1):\n            col_letter = get_column_letter(col)\n            formula = \"=SUM(\" + col_letter + \"2:\" + col_letter + str(row_num - 1) + \")\"\n            ws.cell(row=row_num, column=col, value=formula).font = Font(bold=True)\n\n        buffer = io.BytesIO()\n        wb.save(buffer)\n        buffer.seek(0)\n        b64 = base64.b64encode(buffer.read()).decode()\n        fname = title + \".xlsx\"\n\n        html = \"<div style='padding:15px;background:#e0f2fe;border-radius:8px;'>\"\n        html += \"<h3>Excel Created: \" + fname + \"</h3>\"\n        html += \"</div>\"\n        html += \"<a href='data:application/octet-stream;base64,\" + b64 + \"' download='\" + fname + \"'>Download Excel File</a>\"\n        return html\n"
  }
]
